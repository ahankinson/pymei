from pymei.Components.MeiElement import MeiElement
from pymei.Components.MeiAttribute import MeiAttribute

class abbr_(MeiElement):
    def __init__(self, value=None, parent=None, **attrs):
        MeiElement.__init__(self, name=u"abbr", value=value, parent=parent)
        if attrs:
            self.setattributes(attrs)

class accid_(MeiElement):
    def __init__(self, value=None, parent=None, **attrs):
        MeiElement.__init__(self, name=u"accid", value=value, parent=parent)
        if attrs:
            self.setattributes(attrs)

class address_(MeiElement):
    def __init__(self, value=None, parent=None, **attrs):
        MeiElement.__init__(self, name=u"address", value=value, parent=parent)
        if attrs:
            self.setattributes(attrs)

class addressline_(MeiElement):
    def __init__(self, value=None, parent=None, **attrs):
        MeiElement.__init__(self, name=u"addressline", value=value, parent=parent)
        if attrs:
            self.setattributes(attrs)
            
class annot_(MeiElement):
    def __init__(self, value=None, parent=None, **attrs):
        MeiElement.__init__(self, name=u"annot", value=value, parent=parent)
        if attrs:
            self.setattributes(attrs)

class appinfo_(MeiElement):
    def __init__(self, value=None, parent=None, **attrs):
        MeiElement.__init__(self, name=u"appinfo", value=value, parent=parent)
        if attrs:
            self.setattributes(attrs)

class artic_(MeiElement):
    def __init__(self, value=None, parent=None, **attrs):
        MeiElement.__init__(self, name=u"artic", value=value, parent=parent)
        if attrs:
            self.setattributes(attrs)

class barline_(MeiElement):
    def __init__(self, value=None, parent=None, **attrs):
        MeiElement.__init__(self, name=u"barline", value=value, parent=parent)
        if attrs:
            self.setattributes(attrs)

class bibl_(MeiElement):
    def __init__(self, value=None, parent=None, **attrs):
        MeiElement.__init__(self, name=u"bibl", value=value, parent=parent)
        if attrs:
            self.setattributes(attrs)

class body_(MeiElement):
    def __init__(self, value=None, parent=None, **attrs):
        MeiElement.__init__(self, name=u"body", value=value, parent=parent)
        if attrs:
            self.setattributes(attrs)

class caption_(MeiElement):
    def __init__(self, value=None, parent=None, **attrs):
        MeiElement.__init__(self, name=u"caption", value=value, parent=parent)
        if attrs:
            self.setattributes(attrs)

class chord_(MeiElement):
    def __init__(self, value=None, parent=None, **attrs):
        MeiElement.__init__(self, name=u"chord", value=value, parent=parent)
        if attrs:
            self.setattributes(attrs)

class clef_(MeiElement):
    def __init__(self, value=None, parent=None, **attrs):
        MeiElement.__init__(self, name=u"clef", value=value, parent=parent)
        if attrs:
            self.setattributes(attrs)

class clefchange_(MeiElement):
    def __init__(self, value=None, parent=None, **attrs):
        MeiElement.__init__(self, name=u"clefchange", value=value, parent=parent)
        if attrs:
            self.setattributes(attrs)

class custos_(MeiElement):
    def __init__(self, value=None, parent=None, **attrs):
        MeiElement.__init__(self, name=u"custos", value=value, parent=parent)
        if attrs:
            self.setattributes(attrs)

class date_(MeiElement):
    def __init__(self, value=None, parent=None, **attrs):
        MeiElement.__init__(self, name=u"date", value=value, parent=parent)
        if attrs:
            self.setattributes(attrs)

class dir_(MeiElement):
    def __init__(self, value=None, parent=None, **attrs):
        MeiElement.__init__(self, name=u"dir", value=value, parent=parent)
        if attrs:
            self.setattributes(attrs)

class dot_(MeiElement):
    def __init__(self, value=None, parent=None, **attrs):
        MeiElement.__init__(self, name=u"dot", value=value, parent=parent)
        if attrs:
            self.setattributes(attrs)

class dynam_(MeiElement):
    def __init__(self, value=None, parent=None, **attrs):
        MeiElement.__init__(self, name=u"dynam", value=value, parent=parent)
        if attrs:
            self.setattributes(attrs)

class edition_(MeiElement):
    def __init__(self, value=None, parent=None, **attrs):
        MeiElement.__init__(self, name=u"edition", value=value, parent=parent)
        if attrs:
            self.setattributes(attrs)

class ending_(MeiElement):
    def __init__(self, value=None, parent=None, **attrs):
        MeiElement.__init__(self, name=u"ending", value=value, parent=parent)
        if attrs:
            self.setattributes(attrs)

class expan_(MeiElement):
    def __init__(self, value=None, parent=None, **attrs):
        MeiElement.__init__(self, name=u"expan", value=value, parent=parent)
        if attrs:
            self.setattributes(attrs)

class expansion_(MeiElement):
    def __init__(self, value=None, parent=None, **attrs):
        MeiElement.__init__(self, name=u"expansion", value=value, parent=parent)
        if attrs:
            self.setattributes(attrs)

class fw_(MeiElement):
    def __init__(self, value=None, parent=None, **attrs):
        MeiElement.__init__(self, name=u"fw", value=value, parent=parent)
        if attrs:
            self.setattributes(attrs)

class group_(MeiElement):
    def __init__(self, value=None, parent=None, **attrs):
        MeiElement.__init__(self, name=u"group", value=value, parent=parent)
        if attrs:
            self.setattributes(attrs)

class grpsym_(MeiElement):
    def __init__(self, value=None, parent=None, **attrs):
        MeiElement.__init__(self, name=u"grpsym", value=value, parent=parent)
        if attrs:
            self.setattributes(attrs)

class identifier_(MeiElement):
    def __init__(self, value=None, parent=None, **attrs):
        MeiElement.__init__(self, name=u"identifier", value=value, parent=parent)
        if attrs:
            self.setattributes(attrs)

class instrdef_(MeiElement):
    def __init__(self, value=None, parent=None, **attrs):
        MeiElement.__init__(self, name=u"instrdef", value=value, parent=parent)
        if attrs:
            self.setattributes(attrs)

class instrgrp_(MeiElement):
    def __init__(self, value=None, parent=None, **attrs):
        MeiElement.__init__(self, name=u"instrgrp", value=value, parent=parent)
        if attrs:
            self.setattributes(attrs)

class keyaccid_(MeiElement):
    def __init__(self, value=None, parent=None, **attrs):
        MeiElement.__init__(self, name=u"keyaccid", value=value, parent=parent)
        if attrs:
            self.setattributes(attrs)

class keychange_(MeiElement):
    def __init__(self, value=None, parent=None, **attrs):
        MeiElement.__init__(self, name=u"keychange", value=value, parent=parent)
        if attrs:
            self.setattributes(attrs)

class keysig_(MeiElement):
    def __init__(self, value=None, parent=None, **attrs):
        MeiElement.__init__(self, name=u"keysig", value=value, parent=parent)
        if attrs:
            self.setattributes(attrs)

class label_(MeiElement):
    def __init__(self, value=None, parent=None, **attrs):
        MeiElement.__init__(self, name=u"label", value=value, parent=parent)
        if attrs:
            self.setattributes(attrs)

class layer_(MeiElement):
    def __init__(self, value=None, parent=None, **attrs):
        MeiElement.__init__(self, name=u"layer", value=value, parent=parent)
        if attrs:
            self.setattributes(attrs)

class layerdef_(MeiElement):
    def __init__(self, value=None, parent=None, **attrs):
        MeiElement.__init__(self, name=u"layerdef", value=value, parent=parent)
        if attrs:
            self.setattributes(attrs)

class lb_(MeiElement):
    def __init__(self, value=None, parent=None, **attrs):
        MeiElement.__init__(self, name=u"lb", value=value, parent=parent)
        if attrs:
            self.setattributes(attrs)

class mdiv_(MeiElement):
    def __init__(self, value=None, parent=None, **attrs):
        MeiElement.__init__(self, name=u"mdiv", value=value, parent=parent)
        if attrs:
            self.setattributes(attrs)

class mei_(MeiElement):
    def __init__(self, value=None, parent=None, **attrs):
        MeiElement.__init__(self, name=u"mei", value=value, parent=parent)
        if attrs:
            self.setattributes(attrs)

class music_(MeiElement):
    def __init__(self, value=None, parent=None, **attrs):
        MeiElement.__init__(self, name=u"music", value=value, parent=parent)
        if attrs:
            self.setattributes(attrs)

class name_(MeiElement):
    def __init__(self, value=None, parent=None, **attrs):
        MeiElement.__init__(self, name=u"name", value=value, parent=parent)
        if attrs:
            self.setattributes(attrs)

class note_(MeiElement):
    def __init__(self, value=None, parent=None, **attrs):
        MeiElement.__init__(self, name=u"note", value=value, parent=parent)
        if attrs:
            self.setattributes(attrs)
        self.__pitchname = None
        self.__pitch = None
        self.__duration = None
        self.__octave = None
        self.__stemdir = None
        # a note may have multiple accidentals. This is *not* the same as
        # double-sharps, etc. The MEI spec allows for multiple <accid> child
        # elements on a note.
        self.__accidentals = []
        
        # initialize the note attributes
        self._pitchname
        self._pitch
        self._duration
        self._octave
        self._stemdir
        self._accidentals
    
    # some convenience methods specific to notes. Caches the value for nominally 
    # faster subsequent lookups.
    def get_pitchname(self):
        return self.__pitchname
    pitchname = property(get_pitchname, doc = "Gets the note's pitch name.")
    
    def get_pitch(self):
        return self.__pitch
    pitch = property(get_pitch, doc = "Gets the note's pitch value")
    
    def get_accidentals(self):
        """ Gets a note's accidental value. Stores it as a native MEI accidental
            value, e.g., "f", "ss", "ds", etc.
            
            Note: A note may have multiple accidentals! Thus, this returns a list,
            and not just a single accidental. More often than not, this list 
            will only contain one element, but we're better safe than sorry.
            
         """
         return self.__accidentals
    accidentals = property(get_accidentals, doc = "A note's accidental list.")
    
    def has_accidentals(self):
        """ Returns True if the note has an accidental; False otherwise"""
        # accidentals can be attributes or child attributes.
        if self.has_attribute('accid') or self.has_child('accid'):
            return True
        else:
            # no accidental.
            return False
    
    def get_duration(self):
        return self.__duration
    duration = property(get_duration, doc = "Get's the note's duration")
    
    def get_octave(self):
        return self.__octave
    octave = property(get_octave, doc = "Get's the note's octave.")
    
    def get_stemdir(self):
        return self.__stemdir
    stemdir = property(get_stemdir, doc = "Get's the note's stem direction")
    
    def get_pitch_octave(self):
        """ 
            Returns the sounding pitch and octave representation, e.g. C4, F#2, B-5.
            Sets a default "B" pitch and "4" octave if neither are present, chosen
            simply because this is the middle line on the treble clef.
        """
        pass
    pitch_octave = property(get_pitch_octave, doc = "Gets the pitch and octave representation")


    ## protected 
    def _pitchname(self):
        pname = filter(lambda p: p.name == 'pname', self.attributes)
        # there should only every be one pitch name per note, but the filter() method returns a list.
        if len(pname) > 0:
            self.__pitchname = pname[0].value

    def _pitch(self):
        """ Get's a note's pitch *value*. This is the actual value of the pitch,
            and is returned as a list, containing the pitch name and any accidentals.
        """
        self.__pitch = [self.__pitchname]
    
    def _accidentals(self):
        if self.has_accidentals():
            if self.has_attribute('accid'):
                self.__accidentals = [self.attribute_by_name('accid').value]
            elif self.has_child('accid'):
                a = []
                children = self.children_by_name('accid')
                for child in children:
                    a.append(c.attribute_by_name('accid').value)
                self.__accidentals = a
        
    def _duration(self):
        dur = filter(lambda d: d.getname() == 'dur', self.attributes)
        if len(dur) > 0:
            self.__duration = dur[0].value

    def _octave(self):
        octv = filter(lambda o: o.getname() == 'oct', self.attributes)
        if len(octv) == 0:
            self.__octave = octv[0].value
    
    
    def _stemdir(self):
        stmdir = filter(lambda s: s.getname() == 'stem.dir', self.attributes)
        if len(stmdir) == 0:
            self.__stemdir = stmdir[0].value
    
    
class num_(MeiElement):
    def __init__(self, value=None, parent=None, **attrs):
        MeiElement.__init__(self, name=u"num", value=value, parent=parent)
        if attrs:
            self.setattributes(attrs)

class p_(MeiElement):
    def __init__(self, value=None, parent=None, **attrs):
        MeiElement.__init__(self, name=u"p", value=value, parent=parent)
        if attrs:
            self.setattributes(attrs)

class pad_(MeiElement):
    def __init__(self, value=None, parent=None, **attrs):
        MeiElement.__init__(self, name=u"pad", value=value, parent=parent)
        if attrs:
            self.setattributes(attrs)

class part_(MeiElement):
    def __init__(self, value=None, parent=None, **attrs):
        MeiElement.__init__(self, name=u"part", value=value, parent=parent)
        if attrs:
            self.setattributes(attrs)

class parts_(MeiElement):
    def __init__(self, value=None, parent=None, **attrs):
        MeiElement.__init__(self, name=u"parts", value=value, parent=parent)
        if attrs:
            self.setattributes(attrs)

class pb_(MeiElement):
    def __init__(self, value=None, parent=None, **attrs):
        MeiElement.__init__(self, name=u"pb", value=value, parent=parent)
        if attrs:
            self.setattributes(attrs)

class pgdesc_(MeiElement):
    def __init__(self, value=None, parent=None, **attrs):
        MeiElement.__init__(self, name=u"pgdesc", value=value, parent=parent)
        if attrs:
            self.setattributes(attrs)

class pgfoot1_(MeiElement):
    def __init__(self, value=None, parent=None, **attrs):
        MeiElement.__init__(self, name=u"pgfoot1", value=value, parent=parent)
        if attrs:
            self.setattributes(attrs)

class pgfoot2_(MeiElement):
    def __init__(self, value=None, parent=None, **attrs):
        MeiElement.__init__(self, name=u"pgfoot2", value=value, parent=parent)
        if attrs:
            self.setattributes(attrs)

class pghead1_(MeiElement):
    def __init__(self, value=None, parent=None, **attrs):
        MeiElement.__init__(self, name=u"pghead1", value=value, parent=parent)
        if attrs:
            self.setattributes(attrs)

class pghead2_(MeiElement):
    def __init__(self, value=None, parent=None, **attrs):
        MeiElement.__init__(self, name=u"pghead2", value=value, parent=parent)
        if attrs:
            self.setattributes(attrs)

class phrase_(MeiElement):
    def __init__(self, value=None, parent=None, **attrs):
        MeiElement.__init__(self, name=u"phrase", value=value, parent=parent)
        if attrs:
            self.setattributes(attrs)

class rend_(MeiElement):
    def __init__(self, value=None, parent=None, **attrs):
        MeiElement.__init__(self, name=u"rend", value=value, parent=parent)
        if attrs:
            self.setattributes(attrs)

class repository_(MeiElement):
    def __init__(self, value=None, parent=None, **attrs):
        MeiElement.__init__(self, name=u"repository", value=value, parent=parent)
        if attrs:
            self.setattributes(attrs)

class rest_(MeiElement):
    def __init__(self, value=None, parent=None, **attrs):
        MeiElement.__init__(self, name=u"rest", value=value, parent=parent)
        if attrs:
            self.setattributes(attrs)

class sb_(MeiElement):
    def __init__(self, value=None, parent=None, **attrs):
        MeiElement.__init__(self, name=u"sb", value=value, parent=parent)
        if attrs:
            self.setattributes(attrs)

class score_(MeiElement):
    def __init__(self, value=None, parent=None, **attrs):
        MeiElement.__init__(self, name=u"score", value=value, parent=parent)
        if attrs:
            self.setattributes(attrs)

class scoredef_(MeiElement):
    def __init__(self, value=None, parent=None, **attrs):
        MeiElement.__init__(self, name=u"scoredef", value=value, parent=parent)
        if attrs:
            self.setattributes(attrs)

class section_(MeiElement):
    def __init__(self, value=None, parent=None, **attrs):
        MeiElement.__init__(self, name=u"section", value=value, parent=parent)
        if attrs:
            self.setattributes(attrs)

class space_(MeiElement):
    def __init__(self, value=None, parent=None, **attrs):
        MeiElement.__init__(self, name=u"space", value=value, parent=parent)
        if attrs:
            self.setattributes(attrs)

class stack_(MeiElement):
    def __init__(self, value=None, parent=None, **attrs):
        MeiElement.__init__(self, name=u"stack", value=value, parent=parent)
        if attrs:
            self.setattributes(attrs)

class staff_(MeiElement):
    def __init__(self, value=None, parent=None, **attrs):
        MeiElement.__init__(self, name=u"staff", value=value, parent=parent)
        if attrs:
            self.setattributes(attrs)

class staffdef_(MeiElement):
    def __init__(self, value=None, parent=None, **attrs):
        MeiElement.__init__(self, name=u"staffdef", value=value, parent=parent)
        if attrs:
            self.setattributes(attrs)
    
    def get_clef_array(self):
        # returns an array of clef-related attributes.
        clf = filter(lambda c: c.getname().startswith('clef.'), self.getattributes())
        return clf
    
    def get_ppq(self):
        ppq = filter(lambda p: p.getname() == 'ppq', self.getattributes())
        return ppq[0]
    
    

class staffgrp_(MeiElement):
    def __init__(self, value=None, parent=None, **attrs):
        MeiElement.__init__(self, name=u"staffgrp", value=value, parent=parent)
        if attrs:
            self.setattributes(attrs)

class syl_(MeiElement):
    def __init__(self, value=None, parent=None, **attrs):
        MeiElement.__init__(self, name=u"syl", value=value, parent=parent)
        if attrs:
            self.setattributes(attrs)

class tempo_(MeiElement):
    def __init__(self, value=None, parent=None, **attrs):
        MeiElement.__init__(self, name=u"tempo", value=value, parent=parent)
        if attrs:
            self.setattributes(attrs)

class title_(MeiElement):
    def __init__(self, value=None, parent=None, **attrs):
        MeiElement.__init__(self, name=u"title", value=value, parent=parent)
        if attrs:
            self.setattributes(attrs)

class titlepage_(MeiElement):
    def __init__(self, value=None, parent=None, **attrs):
        MeiElement.__init__(self, name=u"titlepage", value=value, parent=parent)
        if attrs:
            self.setattributes(attrs)

